# project-8-goit
Customer Churn Forecasting for a Telecommunications Company
In order to launch Streamlit App, clone the repository and type 'streamlit run app.py' in terminal in 'interface' folder

üéØ –ü—Ä–æ—î–∫—Ç: –ü—Ä–æ–≥–Ω–æ–∑—É–≤–∞–Ω–Ω—è –í—ñ–¥—Ç–æ–∫—É –ö–ª—ñ—î–Ω—Ç—ñ–≤ (Churn Prediction)

–†–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ–π: https://github.com/bohdanahorbachuk/project-8-goit

1. –û–≥–ª—è–¥ –ü—Ä–æ—î–∫—Ç—É —Ç–∞ –¶—ñ–ª—å

–ú–µ—Ç–æ—é –ø—Ä–æ—î–∫—Ç—É —î —Ä–æ–∑—Ä–æ–±–∫–∞ –≤–∏—Å–æ–∫–æ—Ç–æ—á–Ω–æ—ó –ø—Ä–æ–≥–Ω–æ—Å—Ç–∏—á–Ω–æ—ó –º–æ–¥–µ–ª—ñ –¥–ª—è —ñ–¥–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—ó –∫–ª—ñ—î–Ω—Ç—ñ–≤ —Ç–µ–ª–µ–∫–æ–º—É–Ω—ñ–∫–∞—Ü—ñ–π–Ω–æ—ó –∫–æ–º–ø–∞–Ω—ñ—ó –∑ –≤–∏—Å–æ–∫–æ—é –π–º–æ–≤—ñ—Ä–Ω—ñ—Å—Ç—é –≤—ñ–¥—Ç–æ–∫—É. –¶–µ –¥–æ–∑–≤–æ–ª–∏—Ç—å –∫–æ–º–ø–∞–Ω—ñ—ó –ø—Ä–µ–≤–µ–Ω—Ç–∏–≤–Ω–æ –≤–∂–∏–≤–∞—Ç–∏ –∑–∞—Ö–æ–¥—ñ–≤ –¥–ª—è —É—Ç—Ä–∏–º–∞–Ω–Ω—è –∫–ª—ñ—î–Ω—Ç—ñ–≤.

–¶—ñ–ª—å–æ–≤–∞ –∑–º—ñ–Ω–Ω–∞: churn (–±—ñ–Ω–∞—Ä–Ω–∞: 1 ‚Äî –∫–ª—ñ—î–Ω—Ç –ø—ñ–¥–µ, 0 ‚Äî –∫–ª—ñ—î–Ω—Ç –∑–∞–ª–∏—à–∏—Ç—å—Å—è).

–ö–ª—é—á–æ–≤—ñ –º–µ—Ç—Ä–∏–∫–∏: F1 Score, Recall (–ü–æ–≤–Ω–æ—Ç–∞), Precision, AUC-ROC.

2. üìù –û–ø–∏—Å –î–∞–Ω–∏—Ö —Ç–∞ –ê–Ω–∞–ª—ñ–∑ (EDA)

–í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è –¥–∞—Ç–∞—Å–µ—Ç internet_service_churn.csv (72,274 –∑–∞–ø–∏—Å–∏).
–°—Ç—Ä—É–∫—Ç—É—Ä–∞ –î–∞–Ω–∏—Ö

–ù–∞–∑–≤–∞ –°—Ç–æ–≤–ø—Ü—è

–¢–∏–ø

–†–æ–ª—å / –ö–æ–º–µ–Ω—Ç–∞—Ä

subscription_age

float

–í—ñ–∫ –ø—ñ–¥–ø–∏—Å–∫–∏.

bill_avg

int

–°–µ—Ä–µ–¥–Ω—ñ–π –º—ñ—Å—è—á–Ω–∏–π —Ä–∞—Ö—É–Ω–æ–∫.

reamining_contract

float

–ó–∞–ª–∏—à–æ–∫ —Ç–µ—Ä–º—ñ–Ω—É –∫–æ–Ω—Ç—Ä–∞–∫—Ç—É (—É –º—ñ—Å—è—Ü—è—Ö).

service_failure_count

int

–ö—ñ–ª—å–∫—ñ—Å—Ç—å –∑–∞—Ñ—ñ–∫—Å–æ–≤–∞–Ω–∏—Ö –∑–±–æ—ó–≤ —Å–µ—Ä–≤—ñ—Å—É.

download_avg, upload_avg

float

–°–µ—Ä–µ–¥–Ω—ñ —à–≤–∏–¥–∫–æ—Å—Ç—ñ —Ç—Ä–∞—Ñ—ñ–∫—É.

is_tv_subscriber, is_movie_package_subscriber

int

–ë—ñ–Ω–∞—Ä–Ω—ñ –æ–∑–Ω–∞–∫–∏ –ø—ñ–¥–ø–∏—Å–∫–∏ –Ω–∞ –¥–æ–¥. –ø–æ—Å–ª—É–≥–∏.

2.2. –ö–ª—é—á–æ–≤—ñ –í–∏—Å–Ω–æ–≤–∫–∏ EDA

–ë–∞–ª–∞–Ω—Å –ö–ª–∞—Å—ñ–≤: –ö–ª–∞—Å–∏ churn —î –¥–æ–±—Ä–µ –∑–±–∞–ª–∞–Ω—Å–æ–≤–∞–Ω–∏–º–∏ (55.4% –í—ñ–¥—Ç—ñ–∫).

–ü—Ä–æ–ø—É—Å–∫–∏: –í–∏—è–≤–ª–µ–Ω–æ –∑–Ω–∞—á–Ω—ñ –ø—Ä–æ–ø—É—Å–∫–∏ –≤ 'reamining_contract' (21,572) —Ç–∞ –Ω–µ–∑–Ω–∞—á–Ω—ñ –≤ —Å–µ—Ä–µ–¥–Ω—ñ—Ö —à–≤–∏–¥–∫–æ—Å—Ç—è—Ö.

–ù–∞–π–≤–∞–∂–ª–∏–≤—ñ—à—ñ –û–∑–Ω–∞–∫–∏ (–ö–æ—Ä–µ–ª—è—Ü—ñ—è):

reamining_contract: –°–∏–ª—å–Ω–∞ –Ω–µ–≥–∞—Ç–∏–≤–Ω–∞ –∫–æ—Ä–µ–ª—è—Ü—ñ—è ($\approx -0.63$). –ß–∏–º –¥–æ–≤—à–∏–π –∑–∞–ª–∏—à–æ–∫ –∫–æ–Ω—Ç—Ä–∞–∫—Ç—É, —Ç–∏–º –º–µ–Ω—à–∞ –π–º–æ–≤—ñ—Ä–Ω—ñ—Å—Ç—å –≤—ñ–¥—Ç–æ–∫—É.

–ü–æ—Å–ª—É–≥–∏ —Ç–∞ –¢—Ä–∞—Ñ—ñ–∫: –í—ñ–¥—Å—É—Ç–Ω—ñ—Å—Ç—å –ø—ñ–¥–ø–∏—Å–∫–∏ –Ω–∞ –¢–í/—Ñ—ñ–ª—å–º–∏ —Ç–∞ –Ω–∏–∑—å–∫–∏–π —Å–µ—Ä–µ–¥–Ω—ñ–π —Ç—Ä–∞—Ñ—ñ–∫ ($\approx -0.3$) –∑–±—ñ–ª—å—à—É—é—Ç—å —Ä–∏–∑–∏–∫ –≤—ñ–¥—Ç–æ–∫—É.

3. üõ†Ô∏è –ü–æ–ø–µ—Ä–µ–¥–Ω—è –û–±—Ä–æ–±–∫–∞ –î–∞–Ω–∏—Ö (Preprocessing)

–í—Å—ñ –∫—Ä–æ–∫–∏ –æ–±—Ä–æ–±–∫–∏ –±—É–ª–∏ –≤–∏–∫–æ–Ω–∞–Ω—ñ —Ç–∞ –ø—ñ–¥—Ç–≤–µ—Ä–¥–∏–ª–∏ –ö—ñ–ª—å–∫—ñ—Å—Ç—å NaN: 0.

–í–∏–¥–∞–ª–µ–Ω–Ω—è ID: –í–∏–¥–∞–ª–µ–Ω–æ —Å—Ç–æ–≤–ø–µ—Ü—å 'id'.

–ö–æ–¥—É–≤–∞–Ω–Ω—è: –ó–∞—Å—Ç–æ—Å–æ–≤–∞–Ω–æ Label Encoding (0/1) –¥–ª—è –±—ñ–Ω–∞—Ä–Ω–∏—Ö –æ–∑–Ω–∞–∫.

–û–±—Ä–æ–±–∫–∞ –ü—Ä–æ–ø—É—Å–∫—ñ–≤: –ü—Ä–æ–≤–µ–¥–µ–Ω–æ –ø—Ä–∏–º—É—Å–æ–≤—É –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü—ñ—é –≤ —á–∏—Å–ª–æ–≤–∏–π —Ç–∏–ø, –ø—ñ—Å–ª—è —á–æ–≥–æ –ø—Ä–æ–ø—É—Å–∫–∏ –∑–∞–ø–æ–≤–Ω–µ–Ω—ñ: 'reamining_contract' ‚Äî –Ω—É–ª–µ–º (0), –∞ —Å–µ—Ä–µ–¥–Ω—ñ —à–≤–∏–¥–∫–æ—Å—Ç—ñ ‚Äî —Å–µ—Ä–µ–¥–Ω—ñ–º –∑–Ω–∞—á–µ–Ω–Ω—è–º (.mean()).

–°—Ç–∞–Ω–¥–∞—Ä—Ç–∏–∑–∞—Ü—ñ—è: –£—Å—ñ —á–∏—Å–ª–æ–≤—ñ –æ–∑–Ω–∞–∫–∏ –º–∞—Å—à—Ç–∞–±–æ–≤–∞–Ω—ñ –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é StandardScaler. –û–±'—î–∫—Ç standard_scaler.pkl –∑–±–µ—Ä–µ–∂–µ–Ω–æ –¥–ª—è —ñ–Ω—Ç–µ–≥—Ä–∞—Ü—ñ—ó.

–†–æ–∑–¥—ñ–ª–µ–Ω–Ω—è: –î–∞–Ω—ñ —Ä–æ–∑–¥—ñ–ª–µ–Ω—ñ –Ω–∞ 80% (—Ç—Ä–µ–Ω—É–≤–∞–ª—å–Ω–∏–π) —Ç–∞ 20% (—Ç–µ—Å—Ç–æ–≤–∏–π) –∑—ñ —Å—Ç—Ä–∞—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—î—é.

4. üß† –ù–∞–≤—á–∞–Ω–Ω—è –ú–æ–¥–µ–ª–µ–π —Ç–∞ –§—ñ–Ω–∞–ª—å–Ω—ñ –†–µ–∑—É–ª—å—Ç–∞—Ç–∏

–ü—Ä–æ–≤–µ–¥–µ–Ω–æ –∫–æ–º–ø–ª–µ–∫—Å–Ω–∏–π Grid Search —Ç–∞ –æ—Ü—ñ–Ω—é–≤–∞–Ω–Ω—è —Ç—Ä—å–æ—Ö –∞—Ä—Ö—ñ—Ç–µ–∫—Ç—É—Ä (SVM, RF, NN) –¥–ª—è –≤–∏–±–æ—Ä—É –Ω–∞–π–±—ñ–ª—å—à –ø—Ä–æ–¥—É–∫—Ç–∏–≤–Ω–æ—ó –º–æ–¥–µ–ª—ñ.

4.1. –ö—Ä–æ—Å-–í–∞–ª—ñ–¥–∞—Ü—ñ—è —Ç–∞ –û–ø—Ç–∏–º—ñ–∑–∞—Ü—ñ—è

–ú–µ—Ç–æ–¥: GridSearchCV –∑ cv=5 (–¥–ª—è RF, Decision Tree) —Ç–∞ —Å–ø–µ—Ü—ñ–∞–ª—ñ–∑–æ–≤–∞–Ω—ñ –∫–æ–ª–±–µ–∫–∏ (EarlyStopping –¥–ª—è NN).

–¶—ñ–ª—å: –û–ø—Ç–∏–º—ñ–∑–∞—Ü—ñ—è –∑–∞ –º–µ—Ç—Ä–∏–∫–æ—é F1 Score —Ç–∞/–∞–±–æ Accuracy.

4.2. –§—ñ–Ω–∞–ª—å–Ω–∏–π –†–µ–π—Ç–∏–Ω–≥ –ü—Ä–æ–¥—É–∫—Ç–∏–≤–Ω–æ—Å—Ç—ñ

–ú–æ–¥–µ–ª—å

–ú–µ—Ç–æ–¥–æ–ª–æ–≥—ñ—è

Accuracy (–¢–µ—Å—Ç)

F1 Score (Weighted)

Recall (Churn)

Decision Tree Classifier

–ü–µ—Ä–µ–º–æ–∂–µ—Ü—å –∫–æ–º–ø–ª–µ–∫—Å–Ω–æ–≥–æ GridSearch

0.97

0.97

0.94

–ù–µ–π—Ä–æ–Ω–Ω–∞ –ú–µ—Ä–µ–∂–∞ (NN-1)

Keras/TensorFlow, EarlyStopping

0.945

0.95

0.92

Random Forest (RF)

GridSearchCV, Pipeline

0.94

0.94

0.93

SVM

GridSearchCV

0.92

0.92

0.93

–í–∏–±—ñ—Ä –¥–ª—è –Ü–Ω—Ç–µ–≥—Ä–∞—Ü—ñ—ó: –û–±—Ä–∞–Ω–æ Decision Tree Classifier, –æ—Å–∫—ñ–ª—å–∫–∏ –≤—ñ–Ω –¥–æ—Å—è–≥ –Ω–∞–π–≤–∏—â–æ–≥–æ F1 Score (0.97), —î —à–≤–∏–¥–∫–∏–º —ñ –ø–æ–≤–Ω—ñ—Å—Ç—é –≤–∞–ª—ñ–¥–æ–≤–∞–Ω–∏–º —É —Ä–∞–º–∫–∞—Ö –∫–æ–º–ø–ª–µ–∫—Å–Ω–æ–≥–æ —Ç–µ—Å—Ç—É–≤–∞–Ω–Ω—è.

5. üê≥ –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä–∏–∑–∞—Ü—ñ—è —Ç–∞ –ó–∞–ø—É—Å–∫ –ü—Ä–æ—î–∫—Ç—É

–ü—Ä–æ—î–∫—Ç –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∏–∑–æ–≤–∞–Ω–∏–π –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é Docker –¥–ª—è –∑–∞–±–µ–∑–ø–µ—á–µ–Ω–Ω—è –≤—ñ–¥—Ç–≤–æ—Ä—é–≤–∞–Ω–æ—Å—Ç—ñ. –í–µ–±-—ñ–Ω—Ç–µ—Ä—Ñ–µ–π—Å —Ä–µ–∞–ª—ñ–∑–æ–≤–∞–Ω–æ –Ω–∞ Streamlit.

5.1. Dockerfile (–ö–ª—é—á–æ–≤—ñ –ê—Å–ø–µ–∫—Ç–∏)

–ë–∞–∑–æ–≤–∏–π –û–±—Ä–∞–∑: python:3.10-slim (–æ–ø—Ç–∏–º—ñ–∑–∞—Ü—ñ—è —Ä–æ–∑–º—ñ—Ä—É).

–û–ø—Ç–∏–º—ñ–∑–∞—Ü—ñ—è –ó–∞–ª–µ–∂–Ω–æ—Å—Ç–µ–π: –ó–∞–ª–µ–∂–Ω–æ—Å—Ç—ñ –≤—Å—Ç–∞–Ω–æ–≤–ª—é—é—Ç—å—Å—è –¥–æ –∫–æ–ø—ñ—é–≤–∞–Ω–Ω—è –∫–æ–¥—É –¥–ª—è –µ—Ñ–µ–∫—Ç–∏–≤–Ω–æ–≥–æ –∫–µ—à—É–≤–∞–Ω–Ω—è —à–∞—Ä—ñ–≤. –°–∏—Å—Ç–µ–º–Ω—ñ –ø–∞–∫–µ—Ç–∏ (build-essential) –≤–∏–¥–∞–ª—è—é—Ç—å—Å—è –ø—ñ—Å–ª—è –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è Python-–±—ñ–±–ª—ñ–æ—Ç–µ–∫.

–ó–∞–ø—É—Å–∫: CMD ["streamlit", "run", "app.py", ...]

5.2. Docker Compose (docker-compose.yml)

–§–∞–π–ª Compose —Å–ø—Ä–æ—â—É—î —Å–∫–ª–∞–¥–∞–Ω–Ω—è —Ç–∞ –∑–∞–ø—É—Å–∫ –ø—Ä–æ—î–∫—Ç—É –æ–¥–Ω—ñ—î—é –∫–æ–º–∞–Ω–¥–æ—é.

version: '3.8'
services:
  churn_predictor:
    build: .
    ports:
      - "8501:8501" # –ú–∞–ø—É–≤–∞–Ω–Ω—è –ø–æ—Ä—Ç—É Streamlit
    container_name: churn_predictor_app
    restart: always


5.3. üöÄ –Ü–Ω—Å—Ç—Ä—É–∫—Ü—ñ—è —ñ–∑ –ó–∞–ø—É—Å–∫—É –ü—Ä–æ—î–∫—Ç—É

–î–ª—è –∑–∞–ø—É—Å–∫—É –ø—Ä–æ–≥–Ω–æ—Å—Ç–∏—á–Ω–æ–≥–æ —Å–µ—Ä–≤—ñ—Å—É —É –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ñ –≤–∏–∫–æ–Ω–∞–π—Ç–µ –Ω–∞—Å—Ç—É–ø–Ω—ñ –∫—Ä–æ–∫–∏:

–ö–ª–æ–Ω—É–π—Ç–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ–π:

git clone [https://github.com/bohdanahorbachuk/project-8-goit.git](https://github.com/bohdanahorbachuk/project-8-goit.git)
cd project-8-goit


–ü–µ—Ä–µ–∫–æ–Ω–∞–π—Ç–µ—Å—è —É –Ω–∞—è–≤–Ω–æ—Å—Ç—ñ —Ñ–∞–π–ª—ñ–≤: –£ –∫–æ—Ä–µ–Ω—ñ –ø—Ä–æ—î–∫—Ç—É –º–∞—é—Ç—å –±—É—Ç–∏ Dockerfile, docker-compose.yml, requirements.txt, app.py, best_decision_tree_final.joblib, —Ç–∞ standard_scaler.pkl.

–°–∫–ª–∞–¥–∞–Ω–Ω—è —Ç–∞ –ó–∞–ø—É—Å–∫ (Build and Run):
–í–∏–∫–æ–Ω–∞–π—Ç–µ –∫–æ–º–∞–Ω–¥—É Docker Compose. –í–æ–Ω–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –∑–±–µ—Ä–µ –≤—Å—ñ –∑–∞–ª–µ–∂–Ω–æ—Å—Ç—ñ —Ç–∞ –∑–∞–ø—É—Å—Ç–∏—Ç—å Streamlit-—Å–µ—Ä–≤—ñ—Å.

docker-compose up --build


–î–æ—Å—Ç—É–ø:
–ü—ñ—Å–ª—è –∑–∞–≤–µ—Ä—à–µ–Ω–Ω—è –∑–∞–ø—É—Å–∫—É (–ø–æ–±–∞—á–∏—Ç–µ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è Streamlit), –≤—ñ–¥–∫—Ä–∏–π—Ç–µ —É –±—Ä–∞—É–∑–µ—Ä—ñ –∞–¥—Ä–µ—Å—É:

http://localhost:8501


–ó—É–ø–∏–Ω–∫–∞:
–î–ª—è –∑—É–ø–∏–Ω–∫–∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ —É —Ç–µ—Ä–º—ñ–Ω–∞–ª—ñ, –¥–µ –≤—ñ–Ω –∑–∞–ø—É—â–µ–Ω–∏–π, –Ω–∞—Ç–∏—Å–Ω—ñ—Ç—å Ctrl+C, –∞ –ø–æ—Ç—ñ–º –≤–∏–∫–æ–Ω–∞–π—Ç–µ:

docker-compose down
